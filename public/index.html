<!DOCTYPE html>
<!-- This file could definitely use some love -->

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>css-framework-performance</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,300,600' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css">
</head>

<body style="margin: 100px 0">

  <div class="container">
    <section class="header">
      <h2 class="title">A performance comparison of css approaches.</h2>
      <a href="https://github.com/jantimon/css-framework-performance">
        <img src="https://github.com/jantimon/css-framework-performance/workflows/github%20pages/badge.svg" alt="Deploy Task" />
      </a>
    </section>
    <table class="u-full-width">
      <thead>
        <tr>
          <th>Name</th>
          <th>Report</th>
          <th>Page</th>
          <th>Code</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Vanilla</td>
          <td><a href="reports/vanilla/index.report.html">Report</a></td>
          <td><a href="reports/vanilla/page/">Demo</a></td>
          <td><a
              href="https://github.com/jantimon/css-framework-performance/tree/master/css-frameworks/vanilla">Code</a>
          </td>
          <td>Plain old css using the mini-css-extract-plugin</td>
        </tr>
        <tr>
          <td>Vanilla Style Loader</td>
          <td><a href="reports/vanilla%20style-loader/index.report.html">Report</a></td>
          <td><a href="reports/vanilla%20style-loader/page/">Demo</a></td>
          <td><a
              href="https://github.com/jantimon/css-framework-performance/tree/master/css-frameworks/vanilla%20style-loader">Code</a>
          </td>
          <td>Plain css embededed using the webpack style-loader</td>
        </tr>
        <tr>
          <td>Vanilla with React</td>
          <td><a href="reports/vanilla%20react/index.report.html">Report</a></td>
          <td><a href="reports/vanilla%20react/page/">Demo</a></td>
          <td><a
              href="https://github.com/jantimon/css-framework-performance/tree/master/css-frameworks/vanilla%20react">Code</a>
          </td>
          <td>Plain css classes used by react</td>
        </tr>
        <tr>
          <td>Vanilla with React SSR</td>
          <td><a href="reports/vanilla%20react%20ssr/index.report.html">Report</a></td>
          <td><a href="reports/vanilla%20react%20ssr/page/">Demo</a></td>
          <td><a
              href="https://github.com/jantimon/css-framework-performance/tree/master/css-frameworks/vanilla%20react%20ssr">Code</a>
          </td>
          <td>Plain css classes used by react with server side rendering</td>
        </tr>
        <tr>
          <td>Vanilla with Preact SSR</td>
          <td><a href="reports/vanilla%20preact%20ssr/index.report.html">Report</a></td>
          <td><a href="reports/vanilla%20preact%20ssr/page/">Demo</a></td>
          <td><a
              href="https://github.com/jantimon/css-framework-performance/tree/master/css-frameworks/vanilla%20preact%20ssr">Code</a>
          </td>
          <td>Plain css classes used by preact with server side rendering</td>
        </tr>
      </tbody>
    </table>
  </div>


  <script>
    // Very basic first implementation of audit result injection
    const auditToHtml = (audit) => {
      return `<div>${audit.title}: ${audit.displayValue}</div>`;
    }
    const networkRequestsToHtml = (audit) => {
      const items = audit.details.items;
      const transferSizeSum = items.reduce((sum, item) => sum + item.transferSize, 0);
      return `<div>${items.length} requests - transfer size: ${Math.ceil(transferSizeSum / 1000)}kb</div>`;
    }
    const reportLinks = Array.from(document.querySelectorAll("a[href*=report\\.html]"));
    const reports = reportLinks.map((a) => ({ tableRow: a.closest('tr'), reportUrl: a.href.replace(/\.html$/, '.json') }));
    reports.forEach(async ({ tableRow, reportUrl }) => {
      const reportRequest = await fetch(reportUrl);
      const reportJson = await reportRequest.json();
      const statsRow = document.createElement('tr');
      statsRow.innerHTML = `<td></td><td colspan="4">
      ${auditToHtml(reportJson.audits['first-contentful-paint'])}
      ${auditToHtml(reportJson.audits['first-meaningful-paint'])}
      ${auditToHtml(reportJson.audits['max-potential-fid'])}
      ${networkRequestsToHtml(reportJson.audits['network-requests'])}
    </td>`
      tableRow.parentElement.insertBefore(statsRow, tableRow.nextElementSibling);
    });
  </script>

</body>

</html>